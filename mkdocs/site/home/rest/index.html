


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.2">
    
    
      
        <title>Rest - RTB4FREE</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a2408e81.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rest-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="RTB4FREE" class="md-header-nav__button md-logo" aria-label="RTB4FREE">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            RTB4FREE
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Rest
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="RTB4FREE" class="md-nav__button md-logo" aria-label="RTB4FREE">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    RTB4FREE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../building/" title="Building" class="md-nav__link">
      Building
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deploying/" title="Deploying" class="md-nav__link">
      Deploying
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../userguides.md" title="User Guides" class="md-nav__link">
      User Guides
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../theory/" title="Theory" class="md-nav__link">
      Theory
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../exchanges/" title="Exchanges" class="md-nav__link">
      Exchanges
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://www.apache.org/licenses/LICENSE-2.0" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#endpoint" class="md-nav__link">
    Endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization" class="md-nav__link">
    Authorization
  </a>
  
    <nav class="md-nav" aria-label="Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-token" class="md-nav__link">
    Get Token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop-token" class="md-nav__link">
    Drop Token
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#housekeeping" class="md-nav__link">
    Housekeeping
  </a>
  
    <nav class="md-nav" aria-label="Housekeeping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-shared-resources" class="md-nav__link">
    Get Shared Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-user" class="md-nav__link">
    Get User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-user" class="md-nav__link">
    Add User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-user" class="md-nav__link">
    Delete User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-company" class="md-nav__link">
    Add Company
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-company" class="md-nav__link">
    Delete Company
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieve-user-objects-by-company-id" class="md-nav__link">
    Retrieve User Objects by Company Id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-all-companies" class="md-nav__link">
    List All Companies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-active-tokens" class="md-nav__link">
    List Active Tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-trait-from-profiles" class="md-nav__link">
    Clear Trait from Profiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-profile-from-segment" class="md-nav__link">
    Clear Profile from Segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear-audience-from-persona" class="md-nav__link">
    Clear Audience from Persona
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-trait-memo" class="md-nav__link">
    Get Trait Memo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traits" class="md-nav__link">
    Traits
  </a>
  
    <nav class="md-nav" aria-label="Traits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-computed-trait" class="md-nav__link">
    Add Computed Trait
  </a>
  
    <nav class="md-nav" aria-label="Add Computed Trait">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-counter" class="md-nav__link">
    Event Counter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first" class="md-nav__link">
    First
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#last" class="md-nav__link">
    Last
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique-list" class="md-nav__link">
    Unique List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique-list-count" class="md-nav__link">
    Unique List Count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#most-frequent" class="md-nav__link">
    Most Frequent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregate" class="md-nav__link">
    Aggregate
  </a>
  
    <nav class="md-nav" aria-label="Aggregate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    SQL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-trait" class="md-nav__link">
    Delete Trait
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-trait" class="md-nav__link">
    Execute Trait
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-profile" class="md-nav__link">
    Get Profile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replay" class="md-nav__link">
    Replay
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-time-events" class="md-nav__link">
    Real Time Events
  </a>
  
    <nav class="md-nav" aria-label="Real Time Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heartbeat" class="md-nav__link">
    Heartbeat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-trait" class="md-nav__link">
    Real Time Trait
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-segment" class="md-nav__link">
    Real Time Segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-audience" class="md-nav__link">
    Real Time Audience
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-persona" class="md-nav__link">
    Real Time Persona
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    Query
  </a>
  
    <nav class="md-nav" aria-label="Query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-keys" class="md-nav__link">
    Query Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-by-id" class="md-nav__link">
    Query By Id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query_1" class="md-nav__link">
    Query
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count-user-ids" class="md-nav__link">
    Count User Ids
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persona" class="md-nav__link">
    Persona
  </a>
  
    <nav class="md-nav" aria-label="Persona">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#addedit-persona" class="md-nav__link">
    Add/Edit Persona
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-persona" class="md-nav__link">
    Delete Persona
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-persona" class="md-nav__link">
    Execute Persona
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audience" class="md-nav__link">
    Audience
  </a>
  
    <nav class="md-nav" aria-label="Audience">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#addedit-audience" class="md-nav__link">
    Add/Edit Audience
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-audience" class="md-nav__link">
    Delete Audience
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-audience" class="md-nav__link">
    Execute Audience
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#segment" class="md-nav__link">
    Segment
  </a>
  
    <nav class="md-nav" aria-label="Segment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#addedit-segment" class="md-nav__link">
    Add/Edit Segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-segment" class="md-nav__link">
    Delete Segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-segment" class="md-nav__link">
    Execute Segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addedit-audience_1" class="md-nav__link">
    Add/Edit Audience
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-audience_1" class="md-nav__link">
    Delete Audience
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    Misc
  </a>
  
    <nav class="md-nav" aria-label="Misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-object-in-cache" class="md-nav__link">
    Put Object in Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-accounting" class="md-nav__link">
    Get Accounting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="rest-api">REST API<a class="headerlink" href="#rest-api" title="Permanent link">&para;</a></h1>
<h2 id="endpoint">Endpoint<a class="headerlink" href="#endpoint" title="Permanent link">&para;</a></h2>
<p>All API messages are JSON payloads to a an HTTP POST, to port 8080 on a single node system, at the URI /api</p>
<h2 id="authorization">Authorization<a class="headerlink" href="#authorization" title="Permanent link">&para;</a></h2>
<h3 id="get-token">Get Token<a class="headerlink" href="#get-token" title="Permanent link">&para;</a></h3>
<p>Obtain a JSON web token from the system with the 'Get Token' command. A JSON POST message with the form:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    type: 3,</span>
<span class="err">    customer: customer_name,</span>
<span class="err">    username: user_login_name,</span>
<span class="err">    password: password_value</span>
<span class="err">}</span>
</code></pre></div>


<p>Will return the following structure on success:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: &#39;the-value-will-be-in-here&#39;</span>
<span class="err">}</span>
</code></pre></div>


<p>On error it will have an error flag, and a message, like this:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    error: true,</span>
<span class="err">    message: &#39;no such login&#39;</span>
<span class="err">}</span>
</code></pre></div>


<p>Be aware that tokens expire, and when they do you will receive the following response:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    error: true,</span>
<span class="err">    message: &#39;No such token&#39;</span>
<span class="err">}</span>
</code></pre></div>


<p>You should call get another token to replace the old one.</p>
<h3 id="drop-token">Drop Token<a class="headerlink" href="#drop-token" title="Permanent link">&para;</a></h3>
<p>When you are logging out of the system, issue a Drop Token command. This will remove the token from the cache and
will no longer be usable.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    type: 40,</span>
<span class="err">    token: &quot;&lt;your-toke-value&gt;&quot;</span>
<span class="err">}</span>
</code></pre></div>


<p>If there is no error, the return will look like:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    error: false</span>
<span class="err">}</span>
</code></pre></div>


<p>If error is true, then the token could not be dropped. The attribute 'message' will provide the reason why.</p>
<h2 id="housekeeping">Housekeeping<a class="headerlink" href="#housekeeping" title="Permanent link">&para;</a></h2>
<h3 id="get-shared-resources">Get Shared Resources<a class="headerlink" href="#get-shared-resources" title="Permanent link">&para;</a></h3>
<p>This returns a summary list of information about the IMDG</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    type: 16</span>
<span class="err">};</span>
</code></pre></div>


<h3 id="get-user">Get User<a class="headerlink" href="#get-user" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
This returns a JSON field with information about a user of the system:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    username: username,</span>
<span class="err">    type: 4</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="add-user">Add User<a class="headerlink" href="#add-user" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
Adds a user to the system. You need to provide a stringified version of the user object. Here's an example:</p>
<p>First, a sample user object:</p>
<div class="codehilite"><pre><span></span><code><span class="err">TBD</span>
</code></pre></div>


<p>Then transmit the following:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    user: JSON.stringify(user),</span>
<span class="err">    type: 5</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="delete-user">Delete User<a class="headerlink" href="#delete-user" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
This command will remove the user from the system:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    id: id,</span>
<span class="err">    type: 6</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="add-company">Add Company<a class="headerlink" href="#add-company" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
To add a company to the system (or edit), first create the company object like so:</p>
<div class="codehilite"><pre><span></span><code><span class="err">TBD</span>
</code></pre></div>


<p>Then send the add company command like this:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    id: id,</span>
<span class="err">    type: 9</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="delete-company">Delete Company<a class="headerlink" href="#delete-company" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
To delete a company from the system use:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    id: id,</span>
<span class="err">    type: 9</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="retrieve-user-objects-by-company-id">Retrieve User Objects by Company Id<a class="headerlink" href="#retrieve-user-objects-by-company-id" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
Retrieves all users by their customer id moniker.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    customer_id: cid,</span>
<span class="err">    type: 17</span>
<span class="err">}</span>
</code></pre></div>


<p>Returns a list of user objects.</p>
<h3 id="list-all-companies">List All Companies<a class="headerlink" href="#list-all-companies" title="Permanent link">&para;</a></h3>
<p>(Not available with Okta authentication)
This command retrieves all the company objects.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    type: 18</span>
<span class="err">}</span>
</code></pre></div>


<p>The return is a list of company objects.</p>
<h3 id="list-active-tokens">List Active Tokens<a class="headerlink" href="#list-active-tokens" title="Permanent link">&para;</a></h3>
<p>This command retrieves all the active tokens:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    type: 19</span>
<span class="err">}</span>
</code></pre></div>


<p>The return is a list of tokens.</p>
<h3 id="clear-trait-from-profiles">Clear Trait from Profiles<a class="headerlink" href="#clear-trait-from-profiles" title="Permanent link">&para;</a></h3>
<p>You can clear one or more traits from profiles using the CLEAR API call. This call can remove a trait from a single Profile, or remove a trait from all
profiles.</p>
<p>Form of command for clearing a trait from a known profile "97980cfea0067":</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;profile&quot;,</span>
<span class="err">    item: &quot;97980cfea0067&quot;,</span>
<span class="err">    id: &quot;total_revenue, track_revenue&quot;, </span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>The target is set to 'profile'. The 'item' attribute is set to the id of the profile to modify.
The id is set to one or more traits to clear from the profile. If id is null, all traits will be removed from
the profile.</p>
<p>The return 'results' will be the number of traits remaining. 
To delete a single trait from ALL profiles with that trait, use the following form:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;profile&quot;,</span>
<span class="err">    id: &quot;total_revenue&quot;, </span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>Not specifying the id of the profile implies all profiles with this trait will be removed. The return 'results' will be the number of profiles affected. If an error occurs 'error' will be set to true and 'message' will contain the appropriate error message.</p>
<h3 id="clear-profile-from-segment">Clear Profile from Segment<a class="headerlink" href="#clear-profile-from-segment" title="Permanent link">&para;</a></h3>
<p>You can clear one or more profiles from a segment using the CLEAR API call. This call can remove a profile from a single segment, or remove a profile from all segments.</p>
<p>Form of command for clearing a profile from segment_123 where profile is "97980cfea0067":</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;segment&quot;,</span>
<span class="err">    item: &quot;segment_123&quot;,</span>
<span class="err">    id: &quot;97980cfea0067, 67980cfea0092&quot;, </span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>The target is set to 'segment'. The 'item' attribute is set to the name of the segment to modify.
The id is set to one or more userId's to clear from the segment. If id is null, all userIds will be removed from
the segment.</p>
<p>The return 'results' will be 1 for successful deletion. If the segment did not exist, 0 will be returned. If an error occurs, 'error' will be set to true, and 'message' will contain the explanatory message.</p>
<p>To delete the profile from ALL segments use the following form:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;segment&quot;,</span>
<span class="err">    id: &quot;97980cfea0067&quot;,</span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>Not specifying the id of the segment implies all segments with this profile will be removed. The return 'results' will be the number of segments affected. If an error occurs 'error' will be set to true and 'message' will contain the appropriate error message.</p>
<h3 id="clear-audience-from-persona">Clear Audience from Persona<a class="headerlink" href="#clear-audience-from-persona" title="Permanent link">&para;</a></h3>
<p>You can clear the Audience of user id's from a Persona using the CLEAR API call. 
This call can remove all t from a Persona. Or, remove all the ids from a persona. In addition, you
can remove ids from a Persona-&gt;Audience-&gt;Segment recursively.</p>
<p>Form of command for clearing a profile from a persona where persona is "my_persona":</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;persona&quot;,</span>
<span class="err">    item: &quot;my_persona&quot;,</span>
<span class="err">    id: &quot;97980cfea0067&quot;, </span>
<span class="err">    recursive: true,</span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>The target is set to 'persona'. The 'item' attribute is set to the name of the persona to modify.
The id is set to one or more userId's to clear from the persona. If id is null, all userIds will be removed from
the persona. The optional recursive attribute, if true, will remove the ids from the persona-&gt;audience-&gt;segment.</p>
<p>The return 'results' will be 1 for successful deletion. If the segment did not exist, 0 will be returned. If an error occurs, 'error' will be set to true, and 'message' will contain the explanatory message.</p>
<p>To delete a single profile from ALL personas that contain that id use the following form:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    target: &quot;persona&quot;,</span>
<span class="err">    id: &quot;97980cfea0067&quot;</span>
<span class="err">    type: 39</span>
<span class="err">}</span>
</code></pre></div>


<p>To delete the id recursively, set recursive to true.</p>
<h3 id="get-trait-memo">Get Trait Memo<a class="headerlink" href="#get-trait-memo" title="Permanent link">&para;</a></h3>
<p>This command retrieves a map of the traits, and the number of profiles that have that trait. Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    type: 40</span>
<span class="err">}</span>
</code></pre></div>


<p>The trait object looks like this:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">  &quot;ulist_count&quot;: 7,</span>
<span class="err">  &quot;logins&quot;: 1,</span>
<span class="err">  &quot;name&quot;: 32,</span>
<span class="err">  &quot;last&quot;: 1,</span>
<span class="err">  &quot;tracker&quot;: 8,</span>
<span class="err">  &quot;ulist&quot;: 1,</span>
<span class="err">  &quot;track_revenue&quot;: 32,</span>
<span class="err">  &quot;plan&quot;: 1,</span>
<span class="err">  &quot;email&quot;: 32,</span>
<span class="err">  &quot;address&quot;: 1</span>
<span class="err">}</span>
</code></pre></div>


<p>In the above example, 32 profiles have a 'name' tait, 1 has a 'ulist' trait, 8 profiles have 'tracker'.</p>
<h2 id="traits">Traits<a class="headerlink" href="#traits" title="Permanent link">&para;</a></h2>
<h3 id="add-computed-trait">Add Computed Trait<a class="headerlink" href="#add-computed-trait" title="Permanent link">&para;</a></h3>
<p>This adds a computed trait to the system. If you edit a trait, simply call  add trait to replace the old one.</p>
<p>The different types of traits can be:</p>
<ul>
<li>
<p>Event Counter - An Event Counter trait stores a count of an event over a period of time. 
For example, you can create a trait called number_logins_90_days based on a User Logged In event. 
You can also use event properties to only specific types of events.</p>
<p>User-level examples:  <br />
    Orders Completed Last 30 Days
    Pricing Page Views Last 30 Days</p>
<p>Account-level examples:              <br />
    Total Logins by Account 30 Days
    Emails Opened by Account 90 Days</p>
</li>
<li>
<p>Aggregation - An aggregation computes a sum, average, minimum, or maximum of a numeric event 
property. A good example is a sum_cosmetics_revenue_90_days if you’re sending an Order Completed 
event with a revenue property. In the example we’re refining the revenue even further based on 
another event property: category = 'cosmetics'. Note that you can only compute an aggregation 
trait for event properties that have a numeric value. Aggregation types supported:</p>
<ul>
<li>sum</li>
<li>highest</li>
<li>lowest</li>
<li>mean</li>
<li>variance</li>
<li>geometric mean</li>
<li>second moment</li>
<li>population variance</li>
<li>quadratic mean</li>
<li>standard deviation</li>
<li>square of the log</li>
</ul>
</li>
<li>
<p>Most Frequent - A most frequent user-level computed trait will return the most common value for 
an event property. This is helpful to create traits like preferred_product_viewed or 
most_commonly_viewed_category that tell you what a user’s preferred product, or 
content category might be. Note that the most frequent computed trait requires 
the event property to have been tracked at least twice. In the case of a tie, 
we return the first alphabetical value. For account-level computed traits, you 
can also return the most frequent user trait. This is helpful when you want to 
determine which user has performed an event the most frequently. For example, 
ou might to return the email of the user in an account most actively viewing your app.</p>
<p>User-level examples:  <br />
    Favorite Blog Post
    Top Purchase Category</p>
</li>
<li>
<p>First - The first user-level trait returns the first event property value we have seen. 
This is common for creating traits like first_page_visited based on the page name. For 
accounts, the first computed trait could also return a trait like first_user_signup, 
to calculate the first user to use your product.</p>
<div class="codehilite"><pre><span></span><code><span class="k">User</span><span class="o">-</span><span class="k">level</span> <span class="n">examples</span><span class="p">:</span>        
    <span class="k">First</span> <span class="n">seen</span> <span class="k">timestamp</span>
    <span class="k">First</span> <span class="n">utm</span> <span class="k">parameter</span>

<span class="n">Account</span><span class="o">-</span><span class="k">level</span> <span class="n">examples</span><span class="p">:</span>
    <span class="k">First</span> <span class="n">email</span> <span class="n">opened</span>
    <span class="k">First</span> <span class="k">user</span> <span class="n">signup</span>
</code></pre></div>


</li>
<li>
<p>Last- The last trait returns the last event property value we have seen. This is common for 
creating traits like last_utm_campaign to help you calculate last-touch attribution for 
paid advertising.</p>
<div class="codehilite"><pre><span></span><code><span class="err">User-level examples:    </span>
<span class="err">    Last seen at</span>
<span class="err">    Last utm parameter</span>
</code></pre></div>


</li>
<li>
<p>Unique List - Unique list computed traits will output a list of unique values for an event property. 
This is helpful to understand the different types of products or content that a customer or users in 
an account have interacted with or purchased. Customers are creating traits 
like unique_product_categories_viewed and sending them to email marketing tools and accessing 
them through the Profiles API for in-app personalization.</p>
<div class="codehilite"><pre><span></span><code><span class="err">Example use cases:    </span>
<span class="err">    Unique products purchased</span>
<span class="err">    Unique categories</span>
<span class="err">    Unique games played</span>
</code></pre></div>


</li>
<li>
<p>Unique List Count - Unique list count computed traits will output a count of the unique list of 
values for an event property. Customers are creating traits like unique_product_categories_viewed_count 
to understand the variety of products that a customer is viewing. At the account-level, customers are creating traits like unique_visitors_count to calculate the number of unique visitors by ip address.</p>
<div class="codehilite"><pre><span></span><code><span class="err">User-level examples:      </span>
<span class="err">    Unique products viewed count</span>
<span class="err">    Unique categories count</span>
</code></pre></div>


</li>
</ul>
<p>The command to add the trait is:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    trait: {</span>
<span class="err">        name: &quot;name-of-trait&quot;</span>
<span class="err">        internal: &quot;sql where clause here&quot;.</span>
<span class="err">        ... (other attributes, depends on the trait)</span>
<span class="err">    }</span>
<span class="err">    type: 25</span>
<span class="err">}</span>
</code></pre></div>


<p>Note, use conditions OR internal, but not both. One or the other is required.</p>
<h4 id="event-counter">Event Counter<a class="headerlink" href="#event-counter" title="Permanent link">&para;</a></h4>
<p>Counts the number of times an event has been seen.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;allowsMarketing = true&quot;;</span>
<span class="err">        &quot;eventCounter&quot;:{},</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event to count, internal defines the constraint you wish
to apply. The eventCounter flag is just a non-empty object, with no other attributes.</p>
<p>The response will contain an error field. If errror is true then an errror occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="first">First<a class="headerlink" href="#first" title="Permanent link">&para;</a></h4>
<p>Records the value of the property.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql where clause&quot;,</span>
<span class="err">        &quot;first&quot;:{</span>
<span class="err">            &quot;eventProperty&quot;: &quot;ipAddress&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>The response will contain an error field. If errror is true then an error occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="last">Last<a class="headerlink" href="#last" title="Permanent link">&para;</a></h4>
<p>Records the last value of the property.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql where clause&quot;,</span>
<span class="err">        &quot;last&quot;:{</span>
<span class="err">            &quot;eventProperty&quot;: &quot;ipAddress&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>The response will contain an error field. If errror is true then an error occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="unique-list">Unique List<a class="headerlink" href="#unique-list" title="Permanent link">&para;</a></h4>
<p>Records the unique list of values of the property.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql predicate here&quot;,</span>
<span class="err">        &quot;uniqueList&quot;:{</span>
<span class="err">            &quot;eventProperty&quot;: &quot;app.domain&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>The response will contain an error field. If errror is true then an errror occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="unique-list-count">Unique List Count<a class="headerlink" href="#unique-list-count" title="Permanent link">&para;</a></h4>
<p>Records the count of the  unique list of values of the property.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql predicate here&quot;,</span>
<span class="err">        &quot;uniqueListCount&quot;:{</span>
<span class="err">            &quot;eventProperty&quot;: &quot;app.domain&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>The response will contain an error field. If errror is true then an error occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="most-frequent">Most Frequent<a class="headerlink" href="#most-frequent" title="Permanent link">&para;</a></h4>
<p>Records the most frequently seen value of the property.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Count_logins&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql predicate here&quot;,</span>
<span class="err">        &quot;mostFrequent&quot;:{</span>
<span class="err">            &quot;eventProperty&quot;: &quot;app.domain&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>The response will contain an error field. If errror is true then an error occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h3 id="aggregate">Aggregate<a class="headerlink" href="#aggregate" title="Permanent link">&para;</a></h3>
<p>Applies an aggregation function to a value in traits or properties of a message. This is the
only computed trait that can access the message traits values.</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="ss">&quot;token&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="ss">&quot;trait&quot;</span><span class="err">:</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;name&quot;</span><span class="err">:</span><span class="ss">&quot;Sum_revenue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;eventName&quot;</span><span class="err">:</span><span class="ss">&quot;Logged in&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;internal&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;sql predicate here&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;aggregation&quot;</span><span class="err">:{</span><span class="w"></span>
<span class="w">            </span><span class="ss">&quot;eventProperty&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;revenue&quot;</span><span class="p">,</span><span class="w">                   </span><span class="p">(</span><span class="n">properties</span><span class="o">[</span><span class="n">revenue</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="o">***</span><span class="w"> </span><span class="ow">OR</span><span class="w"> </span><span class="o">***</span><span class="w"></span>
<span class="w">            </span><span class="ss">&quot;userTrait&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;revenue&quot;</span><span class="p">,</span><span class="w">                       </span><span class="p">(</span><span class="n">traits</span><span class="o">[</span><span class="n">revenue</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="ss">&quot;type&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&lt;function-to-apply&gt;&quot;</span><span class="w"></span>
<span class="w">         </span><span class="err">}</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="ss">&quot;lookBack&quot;</span><span class="err">:</span><span class="mi">7</span><span class="w"></span>
<span class="w">     </span><span class="err">}</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="ss">&quot;type&quot;</span><span class="err">:</span><span class="mi">25</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>


<p>Attribute name will be the name of the trait. Attribute eventName is the event we are looking for, internal defines the constraint you wish
to apply. The first object defines either the eventProperty or userTrait you will be using as the value of the trait. </p>
<p>The eventProperty or userTrait (only 1 is allowed) defines the message's attribute that is used as the value. The value of this field
can be a a JSON object, and may include an array object. It may also include a qualifier that will compute the array index to use.</p>
<p>Examples:</p>
<ul>
<li>"app.domain" : Defines a JSON object value under either a user trait or property.</li>
<li>"Brand" : Defines a JSON object Brand under the properties or traits free form object</li>
<li>"products.0.price"  : Defines products array under proprties or traits, 0th index, price.</li>
<li>"products.{products.any.productId = '12908012'}.price":  Defines the array index where products.N.price
is equal to '123456', and retrieves price from that index.</li>
</ul>
<p>Fucntions:
- sum
- highest
- lowest
- mean
- var
- geomean
- smoment
- pvar
- qmean
- std
- slogs</p>
<p>The response will contain an error field. If errror is true then an errror occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h4 id="sql">SQL<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h4>
<p>Records the return value of an SQL query using values of the message in a 
select statement</p>
<p>API Specification:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;token&quot;: &quot;20111ZQtaMtzYYvrMmVv4L7omBbrOZc1b7Mr_-fdvjZ5l4CMcCcMRs8&quot;,</span>
<span class="err">    &quot;trait&quot;: {</span>
<span class="err">        &quot;name&quot;:&quot;Real_owner_of_domain&quot;,</span>
<span class="err">        &quot;eventName&quot;:&quot;Logged in&quot;,</span>
<span class="err">        &quot;internal&quot;: &quot;sql predicate to apply&quot;,</span>
<span class="err">        &quot;sqlTrait&quot;:{</span>
<span class="err">            &quot;driver&quot;: &quot;org.postgresql.Driver&quot;,</span>
<span class="err">            &quot;jdbc&quot;: &quot;postgresql://sqldb/postgres?user=aa?password=bb&quot;,</span>
<span class="err">            &quot;relation&quot;: &quot;testable&quot;,</span>
<span class="err">            &quot;projection&quot;: &quot;realowner&quot;,</span>
<span class="err">            &quot;predicate&quot;: &quot;key = {userId}&quot;</span>
<span class="err">         },</span>
<span class="err">        &quot;lookBack&quot;:7</span>
<span class="err">     },</span>
<span class="err">    &quot;type&quot;:25</span>
<span class="err">}</span>
</code></pre></div>


<p>Equivalent to <em>select realowner from testable where key = {userId}</em></p>
<p userId="userId">Components:
- driver is the SQL driver to use
- jdbc is the login string
- relation is the table name
- projection is the column you are looking for.
- predicate is the where clause. Can reference message values
  Using the macro form. Example, for the message userId:</p>
<p>Value of realowner will be the value of the computed attribute</p>
<p>The response will contain an error field. If errror is true then an error occurred, and 
the message attribute will contain the error. Response of error = false indicates the trait was
added or edited.</p>
<h3 id="delete-trait">Delete Trait<a class="headerlink" href="#delete-trait" title="Permanent link">&para;</a></h3>
<p>To delete a trait from the system:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;&lt;name-of-trait&gt;&quot;,</span>
<span class="err">    type: 26</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="execute-trait">Execute Trait<a class="headerlink" href="#execute-trait" title="Permanent link">&para;</a></h3>
<p>This executes a list of trait using the specified userId:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    userId: userId,</span>
<span class="err">    traits: traits,</span>
<span class="err">    update: update,</span>
<span class="err">    type: 27</span>
<span class="err">}</span>
</code></pre></div>


<p>The userId defines the profile to execute against. The traits is a list of traits to execute at once. The update
field set to true specifies that the profile is to be updated after the execution of the traits.</p>
<h3 id="get-profile">Get Profile<a class="headerlink" href="#get-profile" title="Permanent link">&para;</a></h3>
<p>This command retrieves a profile object by the userId field. </p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">   token: jwt,</span>
<span class="err">   userId: userId,</span>
<span class="err">   type: 28</span>
<span class="err">}</span>
</code></pre></div>


<p>The return is the profile object that matches that userId.</p>
<h3 id="replay">Replay<a class="headerlink" href="#replay" title="Permanent link">&para;</a></h3>
<p>The replay command is used to playback messages through one or more segments or an audience. The results will
be an array of id's returned by each segment executed. Example format:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">   token: jwt,</span>
<span class="err">   sources: [&quot;source-1&quot;,&quot;source-2&quot;,...],</span>
<span class="err">   segments: [&quot;segment1&quot;,&quot;segment2&quot;,...],</span>
<span class="err">   detach: true|false,</span>
<span class="err">   audience: &quot;name-of-audience&quot;,</span>
<span class="err">   type: 32</span>
<span class="err">}</span>
</code></pre></div>


<p>The sources is an array the names of the sources you want to include in the search. If you don't provide any
sources then ALL sources will be included. Use the name, not the writeKey.</p>
<p>The segments when provided are executed in the order you provide. If you provide no segments you must provide
an audience.</p>
<p>The audience, if provided will replay the messages through all the segments within that audience. The result
will be an array of all the ids that are in that segment. If you provide an audience, don't provide segments.</p>
<p>Setting detach will cause the result returned to be a an id to the scratchpad. This id can be used for a query
to the scratchpad to return the current status of the running replay. Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    item: &quot;SCRATCHPADCACHE&quot;,</span>
<span class="err">    sql: &quot;id=&lt;id-returned in the detached replay call&quot;,</span>
<span class="err">    type: 21</span>
<span class="err">}</span>
</code></pre></div>


<p>The return will be an array of message objects, of size 1:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    traits:</span>
<span class="err">        progress: &lt;double-number shows completion&gt;</span>
<span class="err">        completed: true | false</span>
<span class="err">        records: &lt;number-of-total records process on completed&gt;</span>
<span class="err">    ...</span>
<span class="err">}</span>
</code></pre></div>


<p>If completed is true and progress is less than 100.0 then the call errored. If the call did not error, you
can retrieve the results from the segment, or the audience, when it is completed.</p>
<h2 id="real-time-events">Real Time Events<a class="headerlink" href="#real-time-events" title="Permanent link">&para;</a></h2>
<p>Real-time events are available from a web socket interface, normally on port 8887 on a single node system. Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">    &#39;ws://localhost:8887?token=&lt;token-value-from-get-token&#39;</span>
</code></pre></div>


<p>You can also place the token in the header parameter 'token' too. But you must pass the token, otherwise you will not connect.</p>
<p>Immedately upon connecting you will receive a heartbeat message. This will let you know you are connected. Then, once a minute you will receive
the heartbeat. Example:</p>
<h3 id="heartbeat">Heartbeat<a class="headerlink" href="#heartbeat" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">  &quot;stats&quot;: {</span>
<span class="err">    &quot;running&quot;: 0,</span>
<span class="err">    &quot;tokencache&quot;: 1,</span>
<span class="err">    &quot;watch&quot;: 2,</span>
<span class="err">    &quot;identity&quot;: 0,</span>
<span class="err">    &quot;members&quot;: 0,</span>
<span class="err">    &quot;jobs&quot;: 0,</span>
<span class="err">    &quot;deadletter&quot;: 0,</span>
<span class="err">    &quot;profiles&quot;: 0,</span>
<span class="err">    &quot;completed&quot;: 0,</span>
<span class="err">    &quot;messagecache&quot;: 0</span>
<span class="err">  },</span>
<span class="err">  &quot;time&quot;: &quot;2020-05-20T15:46:39.119Z&quot;,</span>
<span class="err">  &quot;event&quot;: &quot;heartbeat&quot;</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="real-time-trait">Real Time Trait<a class="headerlink" href="#real-time-trait" title="Permanent link">&para;</a></h3>
<p>The real time trait will send a message on the socket anytime trait has computed a new value and is associated with a profile.
You will receive the following key fields:</p>
<ul>
<li>type: This will be equal to 'update_trait'.</li>
<li>traitname: This will be the name of the trait that updated.</li>
<li>newvalue: This is the new value for the trait on the indicated message.userId. </li>
<li>message: The message that caused the trait to excute.</li>
</ul>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">  &quot;newvalue&quot;: 17,</span>
<span class="err">  &quot;traitname&quot;: &quot;count_test_events&quot;</span>
<span class="err">  &quot;type&quot;: &quot;update_trait&quot;</span>
<span class="err">  &quot;message&quot;: {</span>
<span class="err">    &quot;id&quot;: &quot;c556d2c3-a37e-4cd7-9976-8b0c3cdf2ec4&quot;,</span>
<span class="err">    &quot;userId&quot;: &quot;97980cfea0067&quot;,</span>
<span class="err">    &quot;action&quot;: &quot;track&quot;,</span>
<span class="err">    &quot;type&quot;: &quot;track&quot;,</span>
<span class="err">    &quot;event&quot;: &quot;Test Event&quot;,</span>
<span class="err">    &quot;sentAt&quot;: &quot;2020-05-06T12:44:04.029Z&quot;,</span>
<span class="err">    &quot;channel&quot;: &quot;web&quot;,</span>
<span class="err">    &quot;context&quot;: {</span>
<span class="err">      &quot;locale&quot;: &quot;en-GB&quot;,</span>
<span class="err">      &quot;userAgent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36&quot;,</span>
<span class="err">      &quot;ip&quot;: &quot;1.2.3.4&quot;,</span>
<span class="err">      &quot;email&quot;: &quot;user@cdp.com&quot;,</span>
<span class="err">      &quot;library&quot;: {</span>
<span class="err">        &quot;name&quot;: &quot;RudderLabs JavaScript SDK&quot;,</span>
<span class="err">        &quot;version&quot;: &quot;1.1.1&quot;</span>
<span class="err">      },</span>
<span class="err">      &quot;app&quot;: {</span>
<span class="err">        &quot;name&quot;: &quot;RudderLabs JavaScript SDK&quot;,</span>
<span class="err">        &quot;version&quot;: &quot;1.1.1&quot;,</span>
<span class="err">        &quot;namespace&quot;: &quot;com.rudderlabs.javascript&quot;</span>
<span class="err">      },</span>
<span class="err">      &quot;screen&quot;: {</span>
<span class="err">        &quot;density&quot;: 1</span>
<span class="err">      },</span>
<span class="err">      &quot;traits&quot;: {</span>
<span class="err">        &quot;email&quot;: &quot;user@cdp.com&quot;</span>
<span class="err">      },</span>
<span class="err">      &quot;os&quot;: {</span>
<span class="err">        &quot;name&quot;: &quot;&quot;,</span>
<span class="err">        &quot;version&quot;: &quot;&quot;</span>
<span class="err">      }</span>
<span class="err">    },</span>
<span class="err">    &quot;messageId&quot;: &quot;edb92d20-70ca-4802-b7c9-4769c43a111a&quot;,</span>
<span class="err">    &quot;timestamp&quot;: &quot;2020-05-20T15:54:27.638288Z&quot;,</span>
<span class="err">    &quot;properties&quot;: {</span>
<span class="err">      &quot;revenue&quot;: 30,</span>
<span class="err">      &quot;currency&quot;: &quot;USD&quot;,</span>
<span class="err">      &quot;user_actual_id&quot;: 1234567890</span>
<span class="err">    },</span>
<span class="err">    &quot;integrations&quot;: {</span>
<span class="err">      &quot;All&quot;: true</span>
<span class="err">    },</span>
<span class="err">    &quot;originalTimestamp&quot;: &quot;2020-05-06T12:44:04.028Z&quot;,</span>
<span class="err">    &quot;anonymousId&quot;: &quot;e705b2b9-9d58-4bb1-b6f7-3b9ca2bd98b2&quot;,</span>
<span class="err">    &quot;writeKey&quot;: &quot;1Zg4SLMGY8rGkj7x1anRIWpMMOa&quot;</span>
<span class="err">  }</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="real-time-segment">Real Time Segment<a class="headerlink" href="#real-time-segment" title="Permanent link">&para;</a></h3>
<p>he real time segment will send a message on the socket anytime profile has been added to a segment.
You will receive the following key fields:</p>
<ul>
<li>type: This will be equal to 'update_segment.</li>
<li>segment: This will be the name of the segment that updated.</li>
<li>newvalue: This is the new profile userId for the segment. </li>
</ul>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
  <span class="ss">&quot;newvalue&quot;</span><span class="p">:</span> <span class="ss">&quot;93dceei134&quot;</span><span class="p">,</span>
  <span class="ss">&quot;segment&quot;</span><span class="p">:</span> <span class="ss">&quot;mynewsegment&quot;</span>
  <span class="ss">&quot;type&quot;</span><span class="p">:</span> <span class="ss">&quot;update_segment&quot;</span>

<span class="err">}</span>
</code></pre></div>


<h3 id="real-time-audience">Real Time Audience<a class="headerlink" href="#real-time-audience" title="Permanent link">&para;</a></h3>
<h3 id="real-time-persona">Real Time Persona<a class="headerlink" href="#real-time-persona" title="Permanent link">&para;</a></h3>
<h2 id="query">Query<a class="headerlink" href="#query" title="Permanent link">&para;</a></h2>
<p>You can query the different caches using these API access points.</p>
<ul>
<li>TOKENCACHE - the login tokens.</li>
<li>MESSAGECACHE - the raw message cache.</li>
<li>PROFILES - user profiles.</li>
<li>TRAITS - computed traits defined in the system</li>
<li>SEGMENTS - segments define</li>
<li>SCRATCHPAD </li>
</ul>
<h3 id="query-keys">Query Keys<a class="headerlink" href="#query-keys" title="Permanent link">&para;</a></h3>
<p>This query retrieves the key fields from object in the IMDG.</p>
<div class="codehilite"><pre><span></span><code><span class="err"> {</span>
<span class="err">    token: jwt,</span>
<span class="err">    item: cache,</span>
<span class="err">    sql: pred,</span>
<span class="err">    type: 20</span>
<span class="err">}</span>
</code></pre></div>


<p>The cache field is the name of the IMap to query from. Examples: "PROFILES", "MESSAGECACHE", "TRAITS". The
pred field are SQL-like query terms on the stored object format. Example using MESSAGECACHE: "userId != null AND context.device.name = android".</p>
<p>The return is a list of ids that match the query. To rereive all ids, pass "" in the sql field.</p>
<p>An example return: </p>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>


<h3 id="query-by-id">Query By Id<a class="headerlink" href="#query-by-id" title="Permanent link">&para;</a></h3>
<p>This will retrieve an object from the IMDG cache based on its key field.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">   token: jwt,</span>
<span class="err">   item: cache,</span>
<span class="err">   key: skey,</span>
<span class="err">   projections: arrayofnames,</span>
<span class="err">   type: 22</span>
<span class="err"> }</span>
</code></pre></div>


<p>The cache field is the name of the IMap to query from. Examples: "PROFILES", "MESSAGECACHE", "TRAITS". The
skey is the id of the object. </p>
<p>The optional projections is an array of field names to return, instead of the entire object. The field names must exist. 
If one or more field names do not exist an error will be returned. The projections works for the following caches: 
TRAITSCACHE, MESSAGECACHE, SEGMENTS, PROFILES, AUDIENCE and PERSONA; all other values are unsupported.</p>
<p>The return is the object with that id in the cache.</p>
<h3 id="query_1">Query<a class="headerlink" href="#query_1" title="Permanent link">&para;</a></h3>
<p>This query retrieves the objects in the IMDG cache that match the query predicate.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
    <span class="n">token</span><span class="p">:</span> <span class="n">jwt</span><span class="p">,</span>
    <span class="n">item</span><span class="p">:</span> <span class="k">cache</span><span class="p">,</span>
    <span class="k">sql</span><span class="p">:</span> <span class="n">pred</span><span class="p">,</span>
    <span class="n">projections</span><span class="p">:</span> <span class="k">names</span><span class="p">,</span>
    <span class="k">type</span><span class="p">:</span> <span class="mi">21</span>

<span class="err">}</span>
</code></pre></div>


<p>The cache field is the name of the IMap to query from. Examples: "PROFILES", "MESSAGECACHE", "TRAITS". </p>
<p>The pred field are SQL-like query terms on the stored object format. Example using MESSAGECACHE: "userId != null AND context.device.name = android".</p>
<p>The projections field, an optional field, is an array of field names you wish to retrieve. The field names must exist, and the pred field cannot be null.</p>
<p>The return is a list of messages. To retrieve all the objects, pass "" in the sql field.</p>
<p>Here is an example command and return from the query of the TRAITS cache:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
    <span class="n">token</span><span class="p">:</span> <span class="n">jwt</span><span class="p">,</span>
    <span class="ss">&quot;item&quot;</span><span class="p">:</span> <span class="ss">&quot;TRAITS&quot;</span><span class="p">,</span>
    <span class="ss">&quot;pred&quot;</span><span class="p">:</span> <span class="ss">&quot;&quot;</span><span class="p">.</span>
    <span class="ss">&quot;type&quot;</span><span class="p">:</span> <span class="mi">21</span>

<span class="err">}</span>
</code></pre></div>


<p>Here is a sample return:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">  &quot;type&quot;: 21,</span>
<span class="err">  &quot;message&quot;: &quot;&quot;,</span>
<span class="err">  &quot;progress&quot;: 100,</span>
<span class="err">  &quot;results&quot;: [</span>
<span class="err">    {</span>
<span class="err">      &quot;id&quot;: &quot;3de1ce22-b3f2-43e8-be95-5130bc36a38c&quot;,</span>
<span class="err">      &quot;name&quot;: &quot;tracker&quot;,</span>
<span class="err">      &quot;realTime&quot;: true,</span>
<span class="err">      &quot;eventName&quot;: &quot;Test Event&quot;,</span>
<span class="err">      &quot;first&quot;: {</span>
<span class="err">        &quot;eventProperty&quot;: &quot;tracker&quot;</span>
<span class="err">      },</span>
<span class="err">      &quot;conditions&quot;: [],</span>
<span class="err">      &quot;lookBack&quot;: 7,</span>
<span class="err">      &quot;timestamp&quot;: &quot;2020-06-15T21:47:40.308784Z&quot;,</span>
<span class="err">      &quot;numUsers&quot;: 0</span>
<span class="err">    },</span>
<span class="err">    {</span>
<span class="err">      &quot;id&quot;: &quot;1135861a-2142-4ba5-9869-c667e5702da5&quot;,</span>
<span class="err">      &quot;name&quot;: &quot;track_revenue&quot;,</span>
<span class="err">      &quot;realTime&quot;: true,</span>
<span class="err">      &quot;eventName&quot;: &quot;Test Event&quot;,</span>
<span class="err">      &quot;aggregation&quot;: {</span>
<span class="err">        &quot;type&quot;: &quot;sum&quot;,</span>
<span class="err">        &quot;eventProperty&quot;: &quot;revenue&quot;</span>
<span class="err">      },</span>
<span class="err">      &quot;lookBack&quot;: 7,</span>
<span class="err">      &quot;timestamp&quot;: &quot;2020-06-15T21:47:40.331528Z&quot;,</span>
<span class="err">      &quot;numUsers&quot;: 0</span>
<span class="err">    }</span>
<span class="err">  ],</span>
<span class="err">  &quot;token&quot;: &quot;20111ATIKX-Q6uQSf3WTU-wXo7ulQd5WS85k5usE3HUdsfp74e30OJi&quot;,</span>
<span class="err">  &quot;item&quot;: &quot;TRAITS&quot;,</span>
<span class="err">  &quot;sql&quot;: &quot;&quot;</span>
<span class="err">}</span>
</code></pre></div>


<p>Now, here is an example using projections on the same query to retrieve "name" and "realTime":</p>
<p>Command;</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
    <span class="n">token</span><span class="p">:</span> <span class="n">jwt</span><span class="p">,</span>
    <span class="ss">&quot;item&quot;</span><span class="p">:</span> <span class="ss">&quot;TRAITS&quot;</span><span class="p">,</span>
    <span class="ss">&quot;pred&quot;</span><span class="p">:</span> <span class="ss">&quot;name!=null&quot;</span><span class="p">,</span>
    <span class="ss">&quot;projections&quot;</span><span class="p">:</span> <span class="p">[</span><span class="ss">&quot;name&quot;</span><span class="p">,</span><span class="ss">&quot;realTime&quot;</span><span class="p">],</span>
    <span class="ss">&quot;type&quot;</span><span class="p">:</span> <span class="mi">21</span>

<span class="err">}</span>
</code></pre></div>


<p>The example return:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">  &quot;type&quot;: 21,</span>
<span class="err">  &quot;message&quot;: &quot;&quot;,</span>
<span class="err">  &quot;progress&quot;: 100,</span>
<span class="err">  &quot;results&quot;: [</span>
<span class="err">    {</span>
<span class="err">      &quot;name&quot;: &quot;tracker&quot;,</span>
<span class="err">      &quot;realTime&quot;: true</span>
<span class="err">    },</span>
<span class="err">    {</span>
<span class="err">      &quot;name&quot;: &quot;track_revenue&quot;,</span>
<span class="err">      &quot;realTime&quot;: true</span>
<span class="err">    }</span>
<span class="err">  ],</span>
<span class="err">  &quot;token&quot;: &quot;20111ATIKX-Q6uQSf3WTU-wXo7ulQd5WS85k5usE3HUdsfp74e30OJi&quot;,</span>
<span class="err">  &quot;item&quot;: &quot;TRAITS&quot;,</span>
<span class="err">  &quot;sql&quot;: &quot;name!=null&quot;</span>
<span class="err">}</span>
</code></pre></div>


<p>Notice, in this version of the command sql is not "". You must put a legal predicate in the sql field that will return what you
are looking for.</p>
<h3 id="count-user-ids">Count User Ids<a class="headerlink" href="#count-user-ids" title="Permanent link">&para;</a></h3>
<p>This will retrieve the number of userids in a SEGMENTS, AUDIENCE and PERSONA cache.</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">   token: jwt,</span>
<span class="err">   item: cache,</span>
<span class="err">   key: skey,</span>
<span class="err">   type: 42</span>
<span class="err"> }</span>
</code></pre></div>


<p>The item field is the name of the IMap to query from, it can be SEGMENTS, AUDIENCE, or PERSONA:. The key is the name of the 
segment, audience or persona you are querying.</p>
<p>Return values - If the item does not support the query (not a SEGMENTS, AUDIENCE or PERSONA), the error field wlll be true. If the key does not
exist in the cache, then error will be true. If error is false, the call succeeded, and the size attribute will contain the number of user ids currently stored in the object.</p>
<h2 id="persona">Persona<a class="headerlink" href="#persona" title="Permanent link">&para;</a></h2>
<h3 id="addedit-persona">Add/Edit Persona<a class="headerlink" href="#addedit-persona" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    audience: &quot;name_of_audience&quot;,</span>
<span class="err">    name: &quot;name_of_persona&quot;,</span>
<span class="err">    destination: &quot;&lt;destination-string&gt;</span>
<span class="err">    traits: [traitname1, traitname2, ..., traitnameN],</span>
<span class="err">    format: &quot;csv-noheader&quot; | &quot;csv&quot; | &quot;json&quot; ,</span>
<span class="err">    realTime: setToTrue-for-realtime,</span>
<span class="err">    type: 36</span>
<span class="err">}</span>
</code></pre></div>


<p>The name is the name of the Persona.</p>
<p>The audience is the name of the audience to output.</p>
<p>The traits array is a list of trait names to be added into the destination.</p>
<p>The format determines how the traits would be added to the output. "csv-noheader" means comma
separated with the elements:</p>
<p>Set realTime to make the persona stream to the destinations.</p>
<p>The destination is a string defining the output, example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">userId,traitname1,traitname2,...,traitnameN</span>
<span class="err">actual-user-id,trait1,trait2,...traitN</span>
</code></pre></div>


<p>In  the case of format is "csv", the header is removed.</p>
<p>In the case of "json":</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    &quot;userId&quot;: &quot;actual-user-id&quot;,</span>
<span class="err">    &quot;traitname1&quot;: &quot;traitvalue1&quot;,</span>
<span class="err">    &quot;traitname2&quot;: &quot;traitvalue2&quot;,</span>
<span class="err">    &quot;traitnameN&quot;: &quot;traitvalueN&quot;</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="delete-persona">Delete Persona<a class="headerlink" href="#delete-persona" title="Permanent link">&para;</a></h3>
<p>Delete a persona by name:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-persona&quot;,</span>
<span class="err">    type: 37</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="execute-persona">Execute Persona<a class="headerlink" href="#execute-persona" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-persona&quot;,</span>
<span class="err">    update: setToTrueToUpdate</span>
<span class="err">    type: 38</span>
<span class="err">}</span>
</code></pre></div>


<h2 id="audience">Audience<a class="headerlink" href="#audience" title="Permanent link">&para;</a></h2>
<h3 id="addedit-audience">Add/Edit Audience<a class="headerlink" href="#addedit-audience" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name_of_audience&quot;,</span>
<span class="err">    internal: &quot;&lt;set-directives&quot;&gt;,</span>
<span class="err">    realTime: setToTrue-for-realtime,</span>
<span class="err">    type: 33</span>
<span class="err">}</span>
</code></pre></div>


<p>The internal attribute will be used to figure out which segments are being used. The form of the command 
is in set operations of membership. Grammar supports segmentnames, AND, OR and NOT. Examples:</p>
<div class="codehilite"><pre><span></span><code><span class="err">segmentA AND segmentB AND NOT segmentC</span>
</code></pre></div>


<p>This means when a userId is added to segmentA, all Audiences containing this segment will be triggered by 
that entry, and then effectively this means: If segmentA contains userId AND segmentB contains userId AND segmentC does not contain userId then this userId is added to the Audience.</p>
<p>Parenthesis can be used to group the operations.</p>
<p>NOT can only appear by itself as the first keyword, as in:</p>
<div class="codehilite"><pre><span></span><code><span class="err">NOT (segmentA OR segmentB)</span>
</code></pre></div>


<p>The following is not a legal expression:</p>
<div class="codehilite"><pre><span></span><code><span class="err">segmentA AND segmentB NOT segmentC       *** NOT VALID</span>
</code></pre></div>


<p>These are valid:</p>
<div class="codehilite"><pre><span></span><code><span class="err">segmentA AND segmentB AND NOT segmentC</span>
<span class="err">segmentA AND segmentB OR NOT segmentC</span>
</code></pre></div>


<p>Note, if you reference a segment that does not exist, then regardless of the userId, that term will
resolve to false.</p>
<p>If you provide no value for the internal attribute, no realtime capability is possible.</p>
<h3 id="delete-audience">Delete Audience<a class="headerlink" href="#delete-audience" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-audience&quot;,</span>
<span class="err">    type: 34</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="execute-audience">Execute Audience<a class="headerlink" href="#execute-audience" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-audience&quot;,</span>
<span class="err">    update: setToTrueToUpdate</span>
<span class="err">    type: 31</span>
<span class="err">}</span>
</code></pre></div>


<h2 id="segment">Segment<a class="headerlink" href="#segment" title="Permanent link">&para;</a></h2>
<h3 id="addedit-segment">Add/Edit Segment<a class="headerlink" href="#addedit-segment" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name_of_segment&quot;,</span>
<span class="err">    conditions: [condition1,condition2, ...],</span>
<span class="err">    internal: &quot;sql where clause here&quot;.</span>
<span class="err">    segment: &quot;name-of-segment&quot;,</span>
<span class="err">    type: 29</span>
<span class="err">}</span>
</code></pre></div>


<p>Note, use conditions OR internal, but not both. One or the other is required.</p>
<p>Using sql attribute allows you to directly provide the operator precedence grammar of queries where clause of the segment.</p>
<p>The condition is a 4 part tuple that looks like the following:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
    <span class="n">apply</span><span class="p">:</span> <span class="o">&lt;</span><span class="nb">boolean</span> <span class="n">application</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="n">lefthandSide</span><span class="p">:</span> <span class="ss">&quot;&lt;left-hand-side of the equation&gt;&quot;</span><span class="p">,</span>
    <span class="k">operator</span><span class="p">:</span> <span class="ss">&quot;&lt;the operator&gt;&quot;</span>
    <span class="n">righthandSide</span><span class="p">:</span> <span class="ss">&quot;&lt;value to test lefthandSide against&quot;</span>
<span class="err">}</span>

<span class="n">Apply</span> <span class="n">can</span> <span class="n">be</span> <span class="n">one</span> <span class="k">of</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>
<span class="o">-</span> <span class="ss">&quot;&quot;</span><span class="p">,</span> <span class="n">implied</span> <span class="k">AND</span>
<span class="o">-</span> <span class="k">AND</span><span class="p">,</span> <span class="k">and</span> <span class="k">with</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">conditions</span>
<span class="o">-</span> <span class="k">OR</span><span class="p">,</span> <span class="k">or</span> <span class="k">with</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">conditions</span>
<span class="o">-</span> <span class="k">NOT</span><span class="p">,</span> <span class="p">(</span><span class="k">AND</span><span class="p">)</span> <span class="k">not</span> <span class="k">with</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">conditions</span><span class="p">.</span>

<span class="n">The</span> <span class="n">lefthandSide</span> <span class="k">is</span> <span class="n">usually</span> <span class="n">the</span> <span class="n">attribute</span> <span class="n">name</span><span class="p">.</span> <span class="k">For</span> <span class="n">example</span> <span class="k">in</span> <span class="n">a</span> <span class="n">track</span> <span class="n">message</span><span class="p">:</span>
<span class="ss">&quot;context.library.version&quot;</span><span class="p">.</span>

<span class="n">The</span> <span class="k">operator</span> <span class="n">can</span> <span class="n">be</span> <span class="n">one</span> <span class="k">of</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>

<span class="o">-</span> <span class="o">=</span>
<span class="o">-</span> <span class="o">!=</span> 
<span class="o">-</span> <span class="o">&gt;</span>
<span class="o">-</span> <span class="o">&gt;=</span>
<span class="o">-</span> <span class="o">&lt;</span>
<span class="o">-</span> <span class="o">&lt;=</span>
<span class="o">-</span> <span class="k">BETWEEN</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="k">BETWEEN</span>
<span class="o">-</span> <span class="k">CONTAINS</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="k">CONTAINS</span>
<span class="o">-</span> <span class="k">IN</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="k">IN</span>
<span class="o">-</span> <span class="k">EXISTS</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="k">EXISTS</span>
<span class="o">-</span> <span class="k">LIKE</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="k">LIKE</span>
<span class="o">-</span> <span class="n">STARTS</span> <span class="k">WITH</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="n">STARTS</span> <span class="k">WITH</span>
<span class="o">-</span> <span class="n">ENDS</span> <span class="k">WITH</span>
<span class="o">-</span> <span class="k">NOT</span> <span class="n">ENDS</span> <span class="k">WITH</span>
</code></pre></div>


<p>The righthandSide depends on the operator. In the case of EXISTS, or NOT EXISTS it is blank, as
it has no meaning in that context.</p>
<p>In the case of BETWEEN and NOT BETWEEN, it is 2 element list with AND joing it. Example "1 AND 2".</p>
<p>In the case of IN, it is a comma separated list in parenthesis. Examples: "(1,2,3)", "('aaa','bbb','ccc')".</p>
<h3 id="delete-segment">Delete Segment<a class="headerlink" href="#delete-segment" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-segment&quot;,</span>
<span class="err">    type: 30</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="execute-segment">Execute Segment<a class="headerlink" href="#execute-segment" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
<span class="err">    token: jwt,</span>
<span class="err">    name: &quot;name-of-segment&quot;,</span>
<span class="err">    update: setToTrueToUpdate</span>
<span class="err">    type: 31</span>
<span class="err">}</span>
</code></pre></div>


<h3 id="addedit-audience_1">Add/Edit Audience<a class="headerlink" href="#addedit-audience_1" title="Permanent link">&para;</a></h3>
<h3 id="delete-audience_1">Delete Audience<a class="headerlink" href="#delete-audience_1" title="Permanent link">&para;</a></h3>
<h2 id="misc">Misc<a class="headerlink" href="#misc" title="Permanent link">&para;</a></h2>
<h3 id="put-object-in-cache">Put Object in Cache<a class="headerlink" href="#put-object-in-cache" title="Permanent link">&para;</a></h3>
<p>The putobject command allows you to put an object into a cache (such as a profile, persona, audience, segment, trait or message). 
Most commonly used to edit a profile in place.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{</span>
   <span class="n">token</span><span class="p">:</span> <span class="n">jwt</span><span class="p">,</span>
   <span class="k">cache</span><span class="p">:</span> <span class="ss">&quot;name-of-cache&quot;</span><span class="p">,</span>
   <span class="k">object</span><span class="p">:</span> <span class="n">theObject</span><span class="p">,</span>
   <span class="k">type</span><span class="p">:</span> <span class="mi">43</span>
<span class="err">}</span>
 <span class="o">```</span>
 <span class="n">The</span> <span class="k">cache</span> <span class="k">is</span> <span class="n">the</span> <span class="n">name</span> <span class="k">of</span> <span class="n">the</span> <span class="n">IMDG</span> <span class="n">Queue</span><span class="p">,</span> <span class="n">example</span> <span class="ss">&quot;PROFILES&quot;</span><span class="p">.</span> <span class="n">The</span> <span class="k">object</span> <span class="k">is</span> <span class="n">the</span> <span class="n">JSON</span> <span class="k">object</span> <span class="k">to</span> <span class="n">put</span> <span class="k">into</span> <span class="n">the</span> <span class="k">cache</span><span class="p">.</span> 
 <span class="n">Depending</span> <span class="k">on</span> <span class="n">the</span> <span class="k">cache</span><span class="p">,</span> <span class="n">the</span>  <span class="k">key</span> <span class="k">is</span> <span class="n">chosen</span> <span class="k">from</span> <span class="n">the</span> <span class="k">object</span><span class="s1">&#39;s attributes. For example, for PROFILES cache the</span>
<span class="s1"> attribute &#39;</span><span class="n">userId</span><span class="err">&#39;</span> <span class="k">is</span> <span class="n">used</span> <span class="k">as</span> <span class="n">the</span> <span class="k">key</span><span class="p">.</span> 

 <span class="n">The</span> <span class="n">following</span> <span class="k">is</span> <span class="n">an</span> <span class="n">example</span> <span class="k">of</span> <span class="n">saving</span> <span class="n">a</span> <span class="n">profile</span><span class="p">:</span>
</code></pre></div>


<p>profile = {
  "devices": [],
  "anonymousIds": [
    "e705b2b9-9d58-4bb1-b6f7-3b9ca2bd98b2",
    "507f191e810c19729de860ea"
  ],
  "messageIds": [
    "2af227ad-85d3-4355-847d-a45db1761ea5",
    "f05263ee-3926-4d69-9b08-f1729009a103",
    "b684873c-4424-4292-bc05-a4f8ffa113df",
    "16c46ef2-3e92-4915-9ef7-8f7eaca06418",
    "cb72b155-8921-4ced-b9c2-dedecea9cf09",
    "9c33321f-6943-46f6-adb5-dd2cc8102ab8",
    "5fd751c7-e3cc-4cd1-a594-0cc0e26e7ba7",
    "72592039-8819-4500-aba9-8139d4deec0d"
  ],
  "ips": [
    "1.2.3.4",
    "8.8.8.8"
  ],
  "apps": [
    {
      "name": "RudderLabs JavaScript SDK",
      "build": "1.0.0",
      "version": "1.1.1",
      "namespace": "com.rudderlabs.javascript"
    }
  ],
  "userId": "97980cfea0067",
  "traits": {
    "revenue": 30,
    "address": {
      "street": "6th St",
      "city": "San Francisco",
      "state": "CA",
      "postalCode": "94103",
      "country": "USA"
    },
    "user_actual_id": 1234567890,
    "name": "Peter Gibbons",
    "track_revenue": 0,
    "currency": "USD",
    "plan": "premium",
    "logins": 5,
    "email": "peter@example.com"
  },
  "id": "84f3dbf6-4022-4287-aa0e-43eff0ca82c1",
  "timestamp": "2020-08-07T19:40:07.499471Z",
  "stringStats": {
    "track_revenue": "rO0ABXNyADtvcmcuYXBhY2hlLmNvbW1vbnMubWF0aDMuc3RhdC5kZXNjcmlwdGl2ZS5TdW1tYXJ5U3RhdGlzdGljc+Py0otcZHjhAgASSgABbkwAB2dlb01lYW50AEBMb3JnL2FwYWNoZS9jb21tb25zL21hdGgzL3N0YXQvZGVzY3JpcHRpdmUvbW9tZW50L0dlb21ldHJpY01lYW47TAALZ2VvTWVhbkltcGx0AEhMb3JnL2FwYWNoZS9jb21tb25zL21hdGgzL3N0YXQvZGVzY3JpcHRpdmUvU3RvcmVsZXNzVW5pdmFyaWF0ZVN0YXRpc3RpYztMAANtYXh0ADRMb3JnL2FwYWNoZS9jb21tb25zL21hdGgzL3N0YXQvZGVzY3JpcHRpdmUvcmFuay9NYXg7TAAHbWF4SW1wbHEAfgACTAAEbWVhbnQAN0xvcmcvYXBhY2hlL2NvbW1vbnMvbWF0aDMvc3RhdC9kZXNjcmlwdGl2ZS9tb21lbnQvTWVhbjtMAAhtZWFuSW1wbHEAfgACTAADbWludAA0TG9yZy9hcGFjaGUvY29tbW9ucy9tYXRoMy9zdGF0L2Rlc2NyaXB0aXZlL3JhbmsvTWluO0wAB21pbkltcGxxAH4AAkwADHNlY29uZE1vbWVudHQAP0xvcmcvYXBhY2hlL2NvbW1vbnMvbWF0aDMvc3RhdC9kZXNjcmlwdGl2ZS9tb21lbnQvU2Vjb25kTW9tZW50O0wAA3N1bXQAN0xvcmcvYXBhY2hlL2NvbW1vbnMvbWF0aDMvc3RhdC9kZXNjcmlwdGl2ZS9zdW1tYXJ5L1N1bTtMAAdzdW1JbXBscQB+AAJMAAZzdW1Mb2d0AD1Mb3JnL2FwYWNoZS9jb21tb25zL21hdGgzL3N0YXQvZGVzY3JpcHRpdmUvc3VtbWFyeS9TdW1PZkxvZ3M7TAAKc3VtTG9nSW1wbHEAfgACTAAFc3Vtc3F0AEBMb3JnL2FwYWNoZS9jb21tb25zL21hdGgzL3N0YXQvZGVzY3JpcHRpdmUvc3VtbWFyeS9TdW1PZlNxdWFyZXM7TAAJc3Vtc3FJbXBscQB+AAJMAAh2YXJpYW5jZXQAO0xvcmcvYXBhY2hlL2NvbW1vbnMvbWF0aDMvc3RhdC9kZXNjcmlwdGl2ZS9tb21lbnQvVmFyaWFuY2U7TAAMdmFyaWFuY2VJbXBscQB+AAJ4cAAAAAAAAABKc3IAPm9yZy5hcGFjaGUuY29tbW9ucy5tYXRoMy5zdGF0LmRlc2NyaXB0aXZlLm1vbWVudC5HZW9tZXRyaWNNZWFujn9L77lMmYMCAAFMAAlzdW1PZkxvZ3NxAH4AAnhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5tYXRoMy5zdGF0LmRlc2NyaXB0aXZlLnN1bW1hcnkuU3VtT2ZMb2dz+t047ubViTUCAAJJAAFuRAAFdmFsdWV4cAAAAEpAb3YJD/WwFnEAfgANc3IAMm9yZy5hcGFjaGUuY29tbW9ucy5tYXRoMy5zdGF0LmRlc2NyaXB0aXZlLnJhbmsuTWF4smBPCiPD8l8CAAJKAAFuRAAFdmFsdWV4cAAAAAAAAABKQD4AAAAAAABxAH4AEXNyADVvcmcuYXBhY2hlLmNvbW1vbnMubWF0aDMuc3RhdC5kZXNjcmlwdGl2ZS5tb21lbnQuTWVhbu4DhxRFeuu0AgACWgAJaW5jTW9tZW50TAAGbW9tZW50dAA+TG9yZy9hcGFjaGUvY29tbW9ucy9tYXRoMy9zdGF0L2Rlc2NyaXB0aXZlL21vbWVudC9GaXJzdE1vbWVudDt4cABzcgA9b3JnLmFwYWNoZS5jb21tb25zLm1hdGgzLnN0YXQuZGVzY3JpcHRpdmUubW9tZW50LlNlY29uZE1vbWVudDa2OsGxxcldAgABRAACbTJ4cgA8b3JnLmFwYWNoZS5jb21tb25zLm1hdGgzLnN0YXQuZGVzY3JpcHRpdmUubW9tZW50LkZpcnN0TW9tZW50VNTekKtB+mkCAAREAANkZXZEAAJtMUoAAW5EAARuRGV2eHAAAAAAAAAAAEA+AAAAAAAAAAAAAAAAAEoAAAAAAAAAAAAAAAAAAAAAcQB+ABRzcgAyb3JnLmFwYWNoZS5jb21tb25zLm1hdGgzLnN0YXQuZGVzY3JpcHRpdmUucmFuay5NaW7XK+5rxc1mhQIAAkoAAW5EAAV2YWx1ZXhwAAAAAAAAAEpAPgAAAAAAAHEAfgAZcQB+ABdzcgA1b3JnLmFwYWNoZS5jb21tb25zLm1hdGgzLnN0YXQuZGVzY3JpcHRpdmUuc3VtbWFyeS5TdW2NwqhziTGjRAIAAkoAAW5EAAV2YWx1ZXhwAAAAAAAAAEpAoVgAAAAAAHEAfgAbcQB+AA9xAH4AD3NyAD5vcmcuYXBhY2hlLmNvbW1vbnMubWF0aDMuc3RhdC5kZXNjcmlwdGl2ZS5zdW1tYXJ5LlN1bU9mU3F1YXJlcxRGd9pLErY4AgACSgABbkQABXZhbHVleHAAAAAAAAAASkDwQoAAAAAAcQB+AB1zcgA5b3JnLmFwYWNoZS5jb21tb25zLm1hdGgzLnN0YXQuZGVzY3JpcHRpdmUubW9tZW50LlZhcmlhbmNlgYvOL1sUZ8YCAANaAAlpbmNNb21lbnRaAA9pc0JpYXNDb3JyZWN0ZWRMAAZtb21lbnRxAH4ABnhwAAFxAH4AF3EAfgAf"
  },
  "_key": "97980cfea0067"
};</p>
<p>cmd = {
   token: jwt,
   cache: "PROFILES",
   object: profile,
   type: 43
};</p>
<p>var response = await axiosInstance.post("htto://localhost:8080/api",JSON.stringify(cmd), { responseType: 'text' }); 
...</p>
<div class="codehilite"><pre><span></span><code><span class="err">###Iterate</span>
<span class="err">The iterate command allows you to retrieve the objects in IMDG Queues, without removing the items.</span>
</code></pre></div>


<p>{
   token: jwt,
   queue: queue,
   limit: limit,
   type: 23
 }
 ```
 The queue is the name of the IMDG Queue, example "JOBS". The limit is the number of items to retrieve. To retrieve
 all objects, don't set the limit. The return is the list of objects in FIFO order.</p>
<p>###Get Replay Messages
 This command is used to retrieve message for a given source, that match a specific predicate.
 The source field is the writeKey of the source. To narrow the messages retrieved, use the pred to match on the
 messages you are looking for, say, by timestamp range.</p>
<p>```
{
    token: jwt,
    pred: pred,
    source: source,
    type: 24
}</p>
<div class="codehilite"><pre><span></span><code><span class="err">Here&#39;s an example to retrieve the replay messages for writeKey xxx that matched userIds 12345 23skiddoo, except</span>
<span class="err">identify records:</span>
</code></pre></div>


<p>{
    token: jwt,
    pred: "(userId = 12345 OR userId = 23skiddoo) AND type != identify",
    source: "xxx",
    type: 24
}
```</p>
<h3 id="get-accounting">Get Accounting<a class="headerlink" href="#get-accounting" title="Permanent link">&para;</a></h3>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>